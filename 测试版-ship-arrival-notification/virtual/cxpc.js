import { createEntityStore } from './create-entity-store.js';
import { onApiMessage } from './api-messages.js';
const store = createEntityStore(x => x.brokerId);
const state = store.state;
onApiMessage({
  COMEX_BROKER_PRICES(data) {
    store.setOne(data);
    store.setFetched();
    for (const callback of pricesReceivedCallbacks) {
      callback(data);
    }
  },
});
const pricesReceivedCallbacks = [];
const cxpcStore = {
  ...state,
  onPricesReceived(callback) {
    pricesReceivedCallbacks.push(callback);
  },
  offPricesReceived(callback) {
    pricesReceivedCallbacks.splice(pricesReceivedCallbacks.indexOf(callback), 1);
  },
};
export { cxpcStore };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3hwYy5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2luZnJhc3RydWN0dXJlL3BydW4tYXBpL2RhdGEvY3hwYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVFbnRpdHlTdG9yZSB9IGZyb20gJ0BzcmMvaW5mcmFzdHJ1Y3R1cmUvcHJ1bi1hcGkvZGF0YS9jcmVhdGUtZW50aXR5LXN0b3JlJztcbmltcG9ydCB7IG9uQXBpTWVzc2FnZSB9IGZyb20gJ0BzcmMvaW5mcmFzdHJ1Y3R1cmUvcHJ1bi1hcGkvZGF0YS9hcGktbWVzc2FnZXMnO1xuXG5jb25zdCBzdG9yZSA9IGNyZWF0ZUVudGl0eVN0b3JlPFBydW5BcGkuQ1hCcm9rZXJQcmljZXM+KHggPT4geC5icm9rZXJJZCk7XG5jb25zdCBzdGF0ZSA9IHN0b3JlLnN0YXRlO1xuXG5vbkFwaU1lc3NhZ2Uoe1xuICBDT01FWF9CUk9LRVJfUFJJQ0VTKGRhdGE6IFBydW5BcGkuQ1hCcm9rZXJQcmljZXMpIHtcbiAgICBzdG9yZS5zZXRPbmUoZGF0YSk7XG4gICAgc3RvcmUuc2V0RmV0Y2hlZCgpO1xuICAgIGZvciAoY29uc3QgY2FsbGJhY2sgb2YgcHJpY2VzUmVjZWl2ZWRDYWxsYmFja3MpIHtcbiAgICAgIGNhbGxiYWNrKGRhdGEpO1xuICAgIH1cbiAgfSxcbn0pO1xuXG5jb25zdCBwcmljZXNSZWNlaXZlZENhbGxiYWNrcyA9IFtdIGFzICgoZGF0YTogUHJ1bkFwaS5DWEJyb2tlclByaWNlcykgPT4gdm9pZClbXTtcblxuZXhwb3J0IGNvbnN0IGN4cGNTdG9yZSA9IHtcbiAgLi4uc3RhdGUsXG4gIG9uUHJpY2VzUmVjZWl2ZWQoY2FsbGJhY2s6IChkYXRhOiBQcnVuQXBpLkNYQnJva2VyUHJpY2VzKSA9PiB2b2lkKSB7XG4gICAgcHJpY2VzUmVjZWl2ZWRDYWxsYmFja3MucHVzaChjYWxsYmFjayk7XG4gIH0sXG4gIG9mZlByaWNlc1JlY2VpdmVkKGNhbGxiYWNrOiAoZGF0YTogUHJ1bkFwaS5DWEJyb2tlclByaWNlcykgPT4gdm9pZCkge1xuICAgIHByaWNlc1JlY2VpdmVkQ2FsbGJhY2tzLnNwbGljZShwcmljZXNSZWNlaXZlZENhbGxiYWNrcy5pbmRleE9mKGNhbGxiYWNrKSwgMSk7XG4gIH0sXG59O1xuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBR0EsTUFBTSxRQUFRLGtCQUEwQyxDQUFBLE1BQUssRUFBRSxRQUFRO0FBQ3ZFLE1BQU0sUUFBUSxNQUFNO0FBRXBCLGFBQWE7QUFBQSxFQUNYLG9CQUFvQixNQUE4QjtBQUNoRCxVQUFNLE9BQU8sSUFBSTtBQUNqQixVQUFNLFdBQUE7QUFDTixlQUFXLFlBQVkseUJBQXlCO0FBQzlDLGVBQVMsSUFBSTtBQUFBLElBQ2Y7QUFBQSxFQUNGO0FBQ0YsQ0FBQztBQUVELE1BQU0sMEJBQTBCLENBQUE7QUFFekIsTUFBTSxZQUFZO0FBQUEsRUFDdkIsR0FBRztBQUFBLEVBQ0gsaUJBQWlCLFVBQWtEO0FBQ2pFLDRCQUF3QixLQUFLLFFBQVE7QUFBQSxFQUN2QztBQUFBLEVBQ0Esa0JBQWtCLFVBQWtEO0FBQ2xFLDRCQUF3QixPQUFPLHdCQUF3QixRQUFRLFFBQVEsR0FBRyxDQUFDO0FBQUEsRUFDN0U7QUFDRjsifQ==
