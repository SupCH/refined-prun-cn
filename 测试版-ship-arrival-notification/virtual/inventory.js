import { storagesStore } from './storage.js';
import { sumMapValues, getStoreLocationName } from './utils.js';
import { shipyardProjectsStore } from './shipyard-projects.js';
import { shipyardsStore } from './shipyards.js';
import { getEntityNameFromAddress, getEntityNaturalIdFromAddress } from './addresses.js';
import { calcMaterialAmountPrice, sumMaterialAmountPrice } from './cx.js';
import { cxosStore } from './cxos.js';
import { warehousesStore } from './warehouses.js';
import { sumBy } from './sum-by.js';
import { sum } from './sum.js';
import {
  sumShipmentDeliveries,
  sumMaterialsPickup,
  sumDeliveries,
  partnerCurrentConditions,
  selfCurrentConditions,
} from './contract-conditions.js';
import { sitesStore } from './sites.js';
import { getPlanetBurn } from './burn2.js';
import { mergeMaterialAmounts } from './sort-materials.js';
import { workInProgress } from './orders2.js';
import { userData } from './user-data.js';
import { isPresent } from './is-present.js';
import { computed } from './runtime-core.esm-bundler.js';
function sumValue(materials) {
  return sumBy(materials, x => x.value);
}
function isPlanetAddress(address) {
  return address?.lines[1]?.type === 'PLANET';
}
function isStationAddress(address) {
  return address?.lines[1]?.type === 'STATION';
}
const inventoryMarketValue = computed(() => {
  const storages = storagesStore.all.value;
  if (!storages) {
    return void 0;
  }
  const inventories = /* @__PURE__ */ new Map();
  for (const storage of storages) {
    const materials = [];
    for (const item of storage.items) {
      if (!item.quantity) {
        continue;
      }
      const value = calcMaterialAmountPrice(item.quantity);
      if (value === void 0) {
        return void 0;
      }
      materials.push({
        material: item.quantity.material,
        amount: item.quantity.amount,
        value,
      });
    }
    inventories.set(storage.id, materials);
  }
  return inventories;
});
function sumStoresValue(stores) {
  const marketValue = inventoryMarketValue.value;
  if (!marketValue || !stores) {
    return void 0;
  }
  let total = 0;
  for (const store of stores) {
    const value = sumValue(marketValue.get(store.id));
    if (value === void 0) {
      return void 0;
    }
    total += value;
  }
  return total;
}
const shipyardInventoryByLocation = computed(() => {
  const projects = shipyardProjectsStore.all.value;
  if (!projects) {
    return void 0;
  }
  const inventories = /* @__PURE__ */ new Map();
  for (const project of projects.filter(x => x.status === 'CREATED')) {
    const value = sumMaterialAmountPrice(project.inventory.items);
    if (value === void 0) {
      return void 0;
    }
    const shipyard = shipyardsStore.getById(project.shipyardId);
    if (!shipyard) {
      continue;
    }
    const name = getEntityNameFromAddress(shipyard.address);
    inventories.set(name, (inventories.get(name) ?? 0) + value);
  }
  return inventories;
});
const shipyardInventory = computed(() => sumMapValues(shipyardInventoryByLocation.value));
const byLocation = computed(() => {
  const marketValue = inventoryMarketValue.value;
  const storages = storagesStore.all.value;
  const shipyards = shipyardInventoryByLocation.value;
  if (!marketValue || !storages || !shipyards) {
    return void 0;
  }
  const inventories = /* @__PURE__ */ new Map();
  for (const store of storages) {
    const totalValue = sumValue(marketValue.get(store.id));
    if (totalValue === void 0) {
      return void 0;
    }
    const name = getStoreLocationName(store);
    inventories.set(name, (inventories.get(name) ?? 0) + totalValue);
  }
  for (const location of shipyards.keys()) {
    const value = shipyards.get(location);
    inventories.set(location, (inventories.get(location) ?? 0) + value);
  }
  return inventories;
});
const cxListedMaterials = computed(() => {
  const sellOrders = cxosStore.all.value?.filter(
    x => x.type === 'SELLING' && x.status !== 'FILLED',
  );
  return sumMaterialAmountPrice(sellOrders);
});
const cxStores = computed(() => storagesStore.all.value?.filter(isCXStore));
function isCXStore(store) {
  if (store.type !== 'WAREHOUSE_STORE') {
    return false;
  }
  const warehouse = warehousesStore.getById(store.addressableId);
  return isStationAddress(warehouse?.address);
}
const mmMaterials = computed(() => new Set(userData.settings.financial.mmMaterials.split(',')));
const cxInventory = computed(() => {
  if (!cxStores.value) {
    return void 0;
  }
  const mmMaterialsTotal2 = /* @__PURE__ */ new Map();
  let otherMaterialsTotal = 0;
  for (const store of cxStores.value) {
    const marketValue = inventoryMarketValue.value?.get(store.id);
    if (!marketValue) {
      return void 0;
    }
    let mmTotal = 0;
    for (const materialValue of marketValue) {
      if (mmMaterials.value.has(materialValue.material.ticker)) {
        mmTotal += materialValue.value;
      } else {
        otherMaterialsTotal += materialValue.value;
      }
    }
    const warehouse = warehousesStore.getById(store.addressableId);
    const naturalId = getEntityNaturalIdFromAddress(warehouse?.address);
    const currencies = {
      ANT: 'AIC',
      BEN: 'CIS',
      MOR: 'NCC',
      HRT: 'ICA',
      HUB: 'NCC',
      ARC: 'CIS',
    };
    const currency = currencies[naturalId];
    mmMaterialsTotal2.set(currency, (mmMaterialsTotal2.get(currency) ?? 0) + mmTotal);
  }
  return {
    mmMaterialsTotal: mmMaterialsTotal2,
    otherMaterialsTotal,
  };
});
const mmMaterialsTotal = computed(() => sumMapValues(cxInventory.value?.mmMaterialsTotal));
const cxInventoryTotal = computed(() => cxInventory.value?.otherMaterialsTotal);
const baseInventory = computed(() => {
  const marketValue = inventoryMarketValue.value;
  const sites = sitesStore.all.value;
  if (!marketValue || !sites) {
    return void 0;
  }
  let finishedGoods2 = 0;
  let rawMaterials2 = 0;
  let workforceConsumables2 = 0;
  let otherItems2 = 0;
  sites.map(getPlanetBurn);
  for (const site of sites) {
    let stores = storagesStore.getByAddressableId(site.siteId);
    const burn = getPlanetBurn(site);
    if (!stores || !burn) {
      return void 0;
    }
    const naturalId = getEntityNaturalIdFromAddress(site.address);
    const warehouse = warehousesStore.getByEntityNaturalId(naturalId);
    const warehouseStore = storagesStore.getById(warehouse?.storeId);
    if (warehouseStore) {
      stores = stores.slice();
      stores.push(warehouseStore);
    }
    const amounts = mergeMaterialAmounts(
      stores.flatMap(x => x.items.map(y => y.quantity).filter(isPresent)),
    );
    for (const amount of amounts) {
      const value = calcMaterialAmountPrice(amount);
      if (value === void 0) {
        return void 0;
      }
      const burnEntry = burn.burn[amount.material.ticker];
      switch (burnEntry?.type) {
        case 'input':
          rawMaterials2 += value;
          break;
        case 'output':
          finishedGoods2 += value;
          break;
        case 'workforce':
          workforceConsumables2 += value;
          break;
        default:
          otherItems2 += value;
          break;
      }
    }
  }
  return {
    finishedGoods: finishedGoods2,
    rawMaterials: rawMaterials2,
    workforceConsumables: workforceConsumables2,
    otherItems: otherItems2,
  };
});
const finishedGoods = computed(() => baseInventory.value?.finishedGoods);
const rawMaterials = computed(() => baseInventory.value?.rawMaterials);
const workforceConsumables = computed(() => baseInventory.value?.workforceConsumables);
const siteNaturalIds = computed(() => {
  const sites = sitesStore.all.value;
  if (!sites) {
    return void 0;
  }
  const naturalIds = /* @__PURE__ */ new Set();
  for (const site of sites) {
    const naturalId = getEntityNaturalIdFromAddress(site.address);
    if (naturalId !== void 0) {
      naturalIds.add(naturalId);
    }
  }
  return naturalIds;
});
const unboundWarehouseStores = computed(() => {
  const naturalIds = siteNaturalIds.value;
  const stores = storagesStore.all.value;
  if (!naturalIds || !stores) {
    return void 0;
  }
  return stores.filter(x => isUnboundWarehouseStore(x, naturalIds));
});
function isUnboundWarehouseStore(store, siteNaturalIds2) {
  if (store.type !== 'WAREHOUSE_STORE') {
    return false;
  }
  const warehouse = warehousesStore.getById(store.addressableId);
  if (!warehouse) {
    return true;
  }
  const address = warehouse.address;
  if (isStationAddress(address)) {
    return false;
  }
  if (!isPlanetAddress(address)) {
    return true;
  }
  const naturalId = getEntityNaturalIdFromAddress(address);
  return naturalId === void 0 || !siteNaturalIds2.has(naturalId);
}
const unboundInventory = computed(() => sumStoresValue(unboundWarehouseStores.value));
const otherItems = computed(() =>
  sum(baseInventory.value?.otherItems, shipyardInventory.value, unboundInventory.value),
);
const fuelStores = computed(() => storagesStore.all.value?.filter(isFuelStore));
function isFuelStore(store) {
  return store.type === 'STL_FUEL_STORE' || store.type === 'FTL_FUEL_STORE';
}
const fuelTanks = computed(() => sumStoresValue(fuelStores.value));
const shipStores = computed(() => storagesStore.all.value?.filter(isShipStore));
function isShipStore(store) {
  return store.type === 'SHIP_STORE';
}
const shipInventory = computed(() => sumStoresValue(shipStores.value));
const materialsInTransit = computed(() =>
  sum(shipInventory.value, sumShipmentDeliveries(partnerCurrentConditions)),
);
const materialsReceivable = computed(() =>
  sum(sumDeliveries(partnerCurrentConditions), sumMaterialsPickup(selfCurrentConditions)),
);
const inventory = {
  byLocation,
  cxListedMaterials,
  cxInventory,
  mmMaterialsTotal,
  cxInventoryTotal,
  materialsInTransit,
  finishedGoods,
  workInProgress,
  rawMaterials,
  workforceConsumables,
  otherItems,
  fuelTanks,
  materialsReceivable,
};
export { inventory };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW52ZW50b3J5LmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29yZS9iYWxhbmNlL2ludmVudG9yeS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzdG9yYWdlc1N0b3JlIH0gZnJvbSAnQHNyYy9pbmZyYXN0cnVjdHVyZS9wcnVuLWFwaS9kYXRhL3N0b3JhZ2UnO1xuaW1wb3J0IHsgZ2V0U3RvcmVMb2NhdGlvbk5hbWUsIHN1bU1hcFZhbHVlcyB9IGZyb20gJ0BzcmMvY29yZS9iYWxhbmNlL3V0aWxzJztcbmltcG9ydCB7IHNoaXB5YXJkUHJvamVjdHNTdG9yZSB9IGZyb20gJ0BzcmMvaW5mcmFzdHJ1Y3R1cmUvcHJ1bi1hcGkvZGF0YS9zaGlweWFyZC1wcm9qZWN0cyc7XG5pbXBvcnQgeyBzaGlweWFyZHNTdG9yZSB9IGZyb20gJ0BzcmMvaW5mcmFzdHJ1Y3R1cmUvcHJ1bi1hcGkvZGF0YS9zaGlweWFyZHMnO1xuaW1wb3J0IHtcbiAgZ2V0RW50aXR5TmFtZUZyb21BZGRyZXNzLFxuICBnZXRFbnRpdHlOYXR1cmFsSWRGcm9tQWRkcmVzcyxcbn0gZnJvbSAnQHNyYy9pbmZyYXN0cnVjdHVyZS9wcnVuLWFwaS9kYXRhL2FkZHJlc3Nlcyc7XG5pbXBvcnQgeyBjYWxjTWF0ZXJpYWxBbW91bnRQcmljZSwgc3VtTWF0ZXJpYWxBbW91bnRQcmljZSB9IGZyb20gJ0BzcmMvaW5mcmFzdHJ1Y3R1cmUvZmlvL2N4JztcbmltcG9ydCB7IGN4b3NTdG9yZSB9IGZyb20gJ0BzcmMvaW5mcmFzdHJ1Y3R1cmUvcHJ1bi1hcGkvZGF0YS9jeG9zJztcbmltcG9ydCB7IHdhcmVob3VzZXNTdG9yZSB9IGZyb20gJ0BzcmMvaW5mcmFzdHJ1Y3R1cmUvcHJ1bi1hcGkvZGF0YS93YXJlaG91c2VzJztcbmltcG9ydCB7IHN1bUJ5IH0gZnJvbSAnQHNyYy91dGlscy9zdW0tYnknO1xuaW1wb3J0IHsgc3VtIH0gZnJvbSAnQHNyYy91dGlscy9zdW0nO1xuaW1wb3J0IHtcbiAgcGFydG5lckN1cnJlbnRDb25kaXRpb25zLFxuICBzZWxmQ3VycmVudENvbmRpdGlvbnMsXG4gIHN1bURlbGl2ZXJpZXMsXG4gIHN1bU1hdGVyaWFsc1BpY2t1cCxcbiAgc3VtU2hpcG1lbnREZWxpdmVyaWVzLFxufSBmcm9tICdAc3JjL2NvcmUvYmFsYW5jZS9jb250cmFjdC1jb25kaXRpb25zJztcbmltcG9ydCB7IHNpdGVzU3RvcmUgfSBmcm9tICdAc3JjL2luZnJhc3RydWN0dXJlL3BydW4tYXBpL2RhdGEvc2l0ZXMnO1xuaW1wb3J0IHsgZ2V0UGxhbmV0QnVybiB9IGZyb20gJ0BzcmMvY29yZS9idXJuJztcbmltcG9ydCB7IG1lcmdlTWF0ZXJpYWxBbW91bnRzIH0gZnJvbSAnQHNyYy9jb3JlL3NvcnQtbWF0ZXJpYWxzJztcbmltcG9ydCB7IHdvcmtJblByb2dyZXNzIH0gZnJvbSAnQHNyYy9jb3JlL2JhbGFuY2Uvb3JkZXJzJztcbmltcG9ydCB7IHVzZXJEYXRhIH0gZnJvbSAnQHNyYy9zdG9yZS91c2VyLWRhdGEnO1xuaW1wb3J0IHsgaXNQcmVzZW50IH0gZnJvbSAndHMtZXh0cmFzJztcblxudHlwZSBMb2NhdGlvbk5hbWUgPSBzdHJpbmc7XG5cbmludGVyZmFjZSBNYXRlcmlhbFZhbHVlIHtcbiAgbWF0ZXJpYWw6IFBydW5BcGkuTWF0ZXJpYWw7XG4gIGFtb3VudDogbnVtYmVyO1xuICB2YWx1ZTogbnVtYmVyO1xufVxuXG5mdW5jdGlvbiBzdW1WYWx1ZShtYXRlcmlhbHM/OiBNYXRlcmlhbFZhbHVlW10pIHtcbiAgcmV0dXJuIHN1bUJ5KG1hdGVyaWFscywgeCA9PiB4LnZhbHVlKTtcbn1cblxuZnVuY3Rpb24gaXNQbGFuZXRBZGRyZXNzKGFkZHJlc3M/OiBQcnVuQXBpLkFkZHJlc3MpIHtcbiAgcmV0dXJuIGFkZHJlc3M/LmxpbmVzWzFdPy50eXBlID09PSAnUExBTkVUJztcbn1cblxuZnVuY3Rpb24gaXNTdGF0aW9uQWRkcmVzcyhhZGRyZXNzPzogUHJ1bkFwaS5BZGRyZXNzKSB7XG4gIHJldHVybiBhZGRyZXNzPy5saW5lc1sxXT8udHlwZSA9PT0gJ1NUQVRJT04nO1xufVxuXG5jb25zdCBpbnZlbnRvcnlNYXJrZXRWYWx1ZSA9IGNvbXB1dGVkKCgpID0+IHtcbiAgY29uc3Qgc3RvcmFnZXMgPSBzdG9yYWdlc1N0b3JlLmFsbC52YWx1ZTtcbiAgaWYgKCFzdG9yYWdlcykge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbiAgY29uc3QgaW52ZW50b3JpZXMgPSBuZXcgTWFwPHN0cmluZywgTWF0ZXJpYWxWYWx1ZVtdPigpO1xuICBmb3IgKGNvbnN0IHN0b3JhZ2Ugb2Ygc3RvcmFnZXMpIHtcbiAgICBjb25zdCBtYXRlcmlhbHM6IE1hdGVyaWFsVmFsdWVbXSA9IFtdO1xuICAgIGZvciAoY29uc3QgaXRlbSBvZiBzdG9yYWdlLml0ZW1zKSB7XG4gICAgICBpZiAoIWl0ZW0ucXVhbnRpdHkpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBjb25zdCB2YWx1ZSA9IGNhbGNNYXRlcmlhbEFtb3VudFByaWNlKGl0ZW0ucXVhbnRpdHkpO1xuICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICAgIG1hdGVyaWFscy5wdXNoKHtcbiAgICAgICAgbWF0ZXJpYWw6IGl0ZW0ucXVhbnRpdHkubWF0ZXJpYWwsXG4gICAgICAgIGFtb3VudDogaXRlbS5xdWFudGl0eS5hbW91bnQsXG4gICAgICAgIHZhbHVlLFxuICAgICAgfSk7XG4gICAgfVxuICAgIGludmVudG9yaWVzLnNldChzdG9yYWdlLmlkLCBtYXRlcmlhbHMpO1xuICB9XG4gIHJldHVybiBpbnZlbnRvcmllcztcbn0pO1xuXG5mdW5jdGlvbiBzdW1TdG9yZXNWYWx1ZShzdG9yZXM6IFBydW5BcGkuU3RvcmVbXSB8IHVuZGVmaW5lZCkge1xuICBjb25zdCBtYXJrZXRWYWx1ZSA9IGludmVudG9yeU1hcmtldFZhbHVlLnZhbHVlO1xuICBpZiAoIW1hcmtldFZhbHVlIHx8ICFzdG9yZXMpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG4gIGxldCB0b3RhbCA9IDA7XG4gIGZvciAoY29uc3Qgc3RvcmUgb2Ygc3RvcmVzKSB7XG4gICAgY29uc3QgdmFsdWUgPSBzdW1WYWx1ZShtYXJrZXRWYWx1ZS5nZXQoc3RvcmUuaWQpKTtcbiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgdG90YWwgKz0gdmFsdWU7XG4gIH1cbiAgcmV0dXJuIHRvdGFsO1xufVxuXG5jb25zdCBzaGlweWFyZEludmVudG9yeUJ5TG9jYXRpb24gPSBjb21wdXRlZCgoKSA9PiB7XG4gIGNvbnN0IHByb2plY3RzID0gc2hpcHlhcmRQcm9qZWN0c1N0b3JlLmFsbC52YWx1ZTtcbiAgaWYgKCFwcm9qZWN0cykge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbiAgY29uc3QgaW52ZW50b3JpZXMgPSBuZXcgTWFwPExvY2F0aW9uTmFtZSwgbnVtYmVyPigpO1xuICBmb3IgKGNvbnN0IHByb2plY3Qgb2YgcHJvamVjdHMuZmlsdGVyKHggPT4geC5zdGF0dXMgPT09ICdDUkVBVEVEJykpIHtcbiAgICBjb25zdCB2YWx1ZSA9IHN1bU1hdGVyaWFsQW1vdW50UHJpY2UocHJvamVjdC5pbnZlbnRvcnkuaXRlbXMpO1xuICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIGNvbnN0IHNoaXB5YXJkID0gc2hpcHlhcmRzU3RvcmUuZ2V0QnlJZChwcm9qZWN0LnNoaXB5YXJkSWQpO1xuICAgIGlmICghc2hpcHlhcmQpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGNvbnN0IG5hbWUgPSBnZXRFbnRpdHlOYW1lRnJvbUFkZHJlc3Moc2hpcHlhcmQuYWRkcmVzcykhO1xuICAgIGludmVudG9yaWVzLnNldChuYW1lLCAoaW52ZW50b3JpZXMuZ2V0KG5hbWUpID8/IDApICsgdmFsdWUpO1xuICB9XG4gIHJldHVybiBpbnZlbnRvcmllcztcbn0pO1xuXG5jb25zdCBzaGlweWFyZEludmVudG9yeSA9IGNvbXB1dGVkKCgpID0+IHN1bU1hcFZhbHVlcyhzaGlweWFyZEludmVudG9yeUJ5TG9jYXRpb24udmFsdWUpKTtcblxuY29uc3QgYnlMb2NhdGlvbiA9IGNvbXB1dGVkKCgpID0+IHtcbiAgY29uc3QgbWFya2V0VmFsdWUgPSBpbnZlbnRvcnlNYXJrZXRWYWx1ZS52YWx1ZTtcbiAgY29uc3Qgc3RvcmFnZXMgPSBzdG9yYWdlc1N0b3JlLmFsbC52YWx1ZTtcbiAgY29uc3Qgc2hpcHlhcmRzID0gc2hpcHlhcmRJbnZlbnRvcnlCeUxvY2F0aW9uLnZhbHVlO1xuICBpZiAoIW1hcmtldFZhbHVlIHx8ICFzdG9yYWdlcyB8fCAhc2hpcHlhcmRzKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICBjb25zdCBpbnZlbnRvcmllcyA9IG5ldyBNYXA8TG9jYXRpb25OYW1lLCBudW1iZXI+KCk7XG4gIGZvciAoY29uc3Qgc3RvcmUgb2Ygc3RvcmFnZXMpIHtcbiAgICBjb25zdCB0b3RhbFZhbHVlID0gc3VtVmFsdWUobWFya2V0VmFsdWUuZ2V0KHN0b3JlLmlkKSk7XG4gICAgaWYgKHRvdGFsVmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBjb25zdCBuYW1lID0gZ2V0U3RvcmVMb2NhdGlvbk5hbWUoc3RvcmUpO1xuICAgIGludmVudG9yaWVzLnNldChuYW1lLCAoaW52ZW50b3JpZXMuZ2V0KG5hbWUpID8/IDApICsgdG90YWxWYWx1ZSk7XG4gIH1cbiAgZm9yIChjb25zdCBsb2NhdGlvbiBvZiBzaGlweWFyZHMua2V5cygpKSB7XG4gICAgY29uc3QgdmFsdWUgPSBzaGlweWFyZHMuZ2V0KGxvY2F0aW9uKSE7XG4gICAgaW52ZW50b3JpZXMuc2V0KGxvY2F0aW9uLCAoaW52ZW50b3JpZXMuZ2V0KGxvY2F0aW9uKSA/PyAwKSArIHZhbHVlKTtcbiAgfVxuICByZXR1cm4gaW52ZW50b3JpZXM7XG59KTtcblxuY29uc3QgY3hMaXN0ZWRNYXRlcmlhbHMgPSBjb21wdXRlZCgoKSA9PiB7XG4gIGNvbnN0IHNlbGxPcmRlcnMgPSBjeG9zU3RvcmUuYWxsLnZhbHVlPy5maWx0ZXIoXG4gICAgeCA9PiB4LnR5cGUgPT09ICdTRUxMSU5HJyAmJiB4LnN0YXR1cyAhPT0gJ0ZJTExFRCcsXG4gICk7XG4gIHJldHVybiBzdW1NYXRlcmlhbEFtb3VudFByaWNlKHNlbGxPcmRlcnMpO1xufSk7XG5cbmNvbnN0IGN4U3RvcmVzID0gY29tcHV0ZWQoKCkgPT4gc3RvcmFnZXNTdG9yZS5hbGwudmFsdWU/LmZpbHRlcihpc0NYU3RvcmUpKTtcblxuZnVuY3Rpb24gaXNDWFN0b3JlKHN0b3JlOiBQcnVuQXBpLlN0b3JlKSB7XG4gIGlmIChzdG9yZS50eXBlICE9PSAnV0FSRUhPVVNFX1NUT1JFJykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGNvbnN0IHdhcmVob3VzZSA9IHdhcmVob3VzZXNTdG9yZS5nZXRCeUlkKHN0b3JlLmFkZHJlc3NhYmxlSWQpO1xuICByZXR1cm4gaXNTdGF0aW9uQWRkcmVzcyh3YXJlaG91c2U/LmFkZHJlc3MpO1xufVxuXG5jb25zdCBtbU1hdGVyaWFscyA9IGNvbXB1dGVkKCgpID0+IG5ldyBTZXQodXNlckRhdGEuc2V0dGluZ3MuZmluYW5jaWFsLm1tTWF0ZXJpYWxzLnNwbGl0KCcsJykpKTtcblxuY29uc3QgY3hJbnZlbnRvcnkgPSBjb21wdXRlZCgoKSA9PiB7XG4gIGlmICghY3hTdG9yZXMudmFsdWUpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgY29uc3QgbW1NYXRlcmlhbHNUb3RhbCA9IG5ldyBNYXA8TG9jYXRpb25OYW1lLCBudW1iZXI+KCk7XG4gIGxldCBvdGhlck1hdGVyaWFsc1RvdGFsID0gMDtcbiAgZm9yIChjb25zdCBzdG9yZSBvZiBjeFN0b3Jlcy52YWx1ZSkge1xuICAgIGNvbnN0IG1hcmtldFZhbHVlID0gaW52ZW50b3J5TWFya2V0VmFsdWUudmFsdWU/LmdldChzdG9yZS5pZCk7XG4gICAgaWYgKCFtYXJrZXRWYWx1ZSkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgbGV0IG1tVG90YWwgPSAwO1xuICAgIGZvciAoY29uc3QgbWF0ZXJpYWxWYWx1ZSBvZiBtYXJrZXRWYWx1ZSkge1xuICAgICAgaWYgKG1tTWF0ZXJpYWxzLnZhbHVlLmhhcyhtYXRlcmlhbFZhbHVlLm1hdGVyaWFsLnRpY2tlcikpIHtcbiAgICAgICAgbW1Ub3RhbCArPSBtYXRlcmlhbFZhbHVlLnZhbHVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb3RoZXJNYXRlcmlhbHNUb3RhbCArPSBtYXRlcmlhbFZhbHVlLnZhbHVlO1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCB3YXJlaG91c2UgPSB3YXJlaG91c2VzU3RvcmUuZ2V0QnlJZChzdG9yZS5hZGRyZXNzYWJsZUlkKTtcbiAgICBjb25zdCBuYXR1cmFsSWQgPSBnZXRFbnRpdHlOYXR1cmFsSWRGcm9tQWRkcmVzcyh3YXJlaG91c2U/LmFkZHJlc3MpITtcbiAgICBjb25zdCBjdXJyZW5jaWVzID0ge1xuICAgICAgQU5UOiAnQUlDJyxcbiAgICAgIEJFTjogJ0NJUycsXG4gICAgICBNT1I6ICdOQ0MnLFxuICAgICAgSFJUOiAnSUNBJyxcbiAgICAgIEhVQjogJ05DQycsXG4gICAgICBBUkM6ICdDSVMnLFxuICAgIH07XG4gICAgY29uc3QgY3VycmVuY3kgPSBjdXJyZW5jaWVzW25hdHVyYWxJZF07XG4gICAgbW1NYXRlcmlhbHNUb3RhbC5zZXQoY3VycmVuY3ksIChtbU1hdGVyaWFsc1RvdGFsLmdldChjdXJyZW5jeSkgPz8gMCkgKyBtbVRvdGFsKTtcbiAgfVxuICByZXR1cm4ge1xuICAgIG1tTWF0ZXJpYWxzVG90YWwsXG4gICAgb3RoZXJNYXRlcmlhbHNUb3RhbCxcbiAgfTtcbn0pO1xuXG5jb25zdCBtbU1hdGVyaWFsc1RvdGFsID0gY29tcHV0ZWQoKCkgPT4gc3VtTWFwVmFsdWVzKGN4SW52ZW50b3J5LnZhbHVlPy5tbU1hdGVyaWFsc1RvdGFsKSk7XG5cbmNvbnN0IGN4SW52ZW50b3J5VG90YWwgPSBjb21wdXRlZCgoKSA9PiBjeEludmVudG9yeS52YWx1ZT8ub3RoZXJNYXRlcmlhbHNUb3RhbCk7XG5cbmNvbnN0IGJhc2VJbnZlbnRvcnkgPSBjb21wdXRlZCgoKSA9PiB7XG4gIGNvbnN0IG1hcmtldFZhbHVlID0gaW52ZW50b3J5TWFya2V0VmFsdWUudmFsdWU7XG4gIGNvbnN0IHNpdGVzID0gc2l0ZXNTdG9yZS5hbGwudmFsdWU7XG4gIGlmICghbWFya2V0VmFsdWUgfHwgIXNpdGVzKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIGxldCBmaW5pc2hlZEdvb2RzID0gMDtcbiAgbGV0IHJhd01hdGVyaWFscyA9IDA7XG4gIGxldCB3b3JrZm9yY2VDb25zdW1hYmxlcyA9IDA7XG4gIGxldCBvdGhlckl0ZW1zID0gMDtcbiAgLy8gUHJlLXdhcm0gYWxsIHBsYW5ldCBidXJucy5cbiAgc2l0ZXMubWFwKGdldFBsYW5ldEJ1cm4pO1xuICBmb3IgKGNvbnN0IHNpdGUgb2Ygc2l0ZXMpIHtcbiAgICBsZXQgc3RvcmVzID0gc3RvcmFnZXNTdG9yZS5nZXRCeUFkZHJlc3NhYmxlSWQoc2l0ZS5zaXRlSWQpO1xuICAgIGNvbnN0IGJ1cm4gPSBnZXRQbGFuZXRCdXJuKHNpdGUpO1xuICAgIGlmICghc3RvcmVzIHx8ICFidXJuKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBjb25zdCBuYXR1cmFsSWQgPSBnZXRFbnRpdHlOYXR1cmFsSWRGcm9tQWRkcmVzcyhzaXRlLmFkZHJlc3MpO1xuICAgIGNvbnN0IHdhcmVob3VzZSA9IHdhcmVob3VzZXNTdG9yZS5nZXRCeUVudGl0eU5hdHVyYWxJZChuYXR1cmFsSWQpO1xuICAgIGNvbnN0IHdhcmVob3VzZVN0b3JlID0gc3RvcmFnZXNTdG9yZS5nZXRCeUlkKHdhcmVob3VzZT8uc3RvcmVJZCk7XG4gICAgaWYgKHdhcmVob3VzZVN0b3JlKSB7XG4gICAgICBzdG9yZXMgPSBzdG9yZXMuc2xpY2UoKTtcbiAgICAgIHN0b3Jlcy5wdXNoKHdhcmVob3VzZVN0b3JlKTtcbiAgICB9XG4gICAgY29uc3QgYW1vdW50cyA9IG1lcmdlTWF0ZXJpYWxBbW91bnRzKFxuICAgICAgc3RvcmVzLmZsYXRNYXAoeCA9PiB4Lml0ZW1zLm1hcCh5ID0+IHkucXVhbnRpdHkpLmZpbHRlcihpc1ByZXNlbnQpKSxcbiAgICApO1xuICAgIGZvciAoY29uc3QgYW1vdW50IG9mIGFtb3VudHMpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gY2FsY01hdGVyaWFsQW1vdW50UHJpY2UoYW1vdW50KTtcbiAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgICBjb25zdCBidXJuRW50cnkgPSBidXJuLmJ1cm5bYW1vdW50Lm1hdGVyaWFsLnRpY2tlcl07XG4gICAgICBzd2l0Y2ggKGJ1cm5FbnRyeT8udHlwZSkge1xuICAgICAgICBjYXNlICdpbnB1dCc6XG4gICAgICAgICAgcmF3TWF0ZXJpYWxzICs9IHZhbHVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdvdXRwdXQnOlxuICAgICAgICAgIGZpbmlzaGVkR29vZHMgKz0gdmFsdWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3dvcmtmb3JjZSc6XG4gICAgICAgICAgd29ya2ZvcmNlQ29uc3VtYWJsZXMgKz0gdmFsdWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgb3RoZXJJdGVtcyArPSB2YWx1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBmaW5pc2hlZEdvb2RzLFxuICAgIHJhd01hdGVyaWFscyxcbiAgICB3b3JrZm9yY2VDb25zdW1hYmxlcyxcbiAgICBvdGhlckl0ZW1zLFxuICB9O1xufSk7XG5cbmNvbnN0IGZpbmlzaGVkR29vZHMgPSBjb21wdXRlZCgoKSA9PiBiYXNlSW52ZW50b3J5LnZhbHVlPy5maW5pc2hlZEdvb2RzKTtcblxuY29uc3QgcmF3TWF0ZXJpYWxzID0gY29tcHV0ZWQoKCkgPT4gYmFzZUludmVudG9yeS52YWx1ZT8ucmF3TWF0ZXJpYWxzKTtcblxuY29uc3Qgd29ya2ZvcmNlQ29uc3VtYWJsZXMgPSBjb21wdXRlZCgoKSA9PiBiYXNlSW52ZW50b3J5LnZhbHVlPy53b3JrZm9yY2VDb25zdW1hYmxlcyk7XG5cbmNvbnN0IHNpdGVOYXR1cmFsSWRzID0gY29tcHV0ZWQoKCkgPT4ge1xuICBjb25zdCBzaXRlcyA9IHNpdGVzU3RvcmUuYWxsLnZhbHVlO1xuICBpZiAoIXNpdGVzKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIGNvbnN0IG5hdHVyYWxJZHMgPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgZm9yIChjb25zdCBzaXRlIG9mIHNpdGVzKSB7XG4gICAgY29uc3QgbmF0dXJhbElkID0gZ2V0RW50aXR5TmF0dXJhbElkRnJvbUFkZHJlc3Moc2l0ZS5hZGRyZXNzKTtcbiAgICBpZiAobmF0dXJhbElkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIG5hdHVyYWxJZHMuYWRkKG5hdHVyYWxJZCk7XG4gICAgfVxuICB9XG4gIHJldHVybiBuYXR1cmFsSWRzO1xufSk7XG5cbmNvbnN0IHVuYm91bmRXYXJlaG91c2VTdG9yZXMgPSBjb21wdXRlZCgoKSA9PiB7XG4gIGNvbnN0IG5hdHVyYWxJZHMgPSBzaXRlTmF0dXJhbElkcy52YWx1ZTtcbiAgY29uc3Qgc3RvcmVzID0gc3RvcmFnZXNTdG9yZS5hbGwudmFsdWU7XG4gIGlmICghbmF0dXJhbElkcyB8fCAhc3RvcmVzKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIHJldHVybiBzdG9yZXMuZmlsdGVyKHggPT4gaXNVbmJvdW5kV2FyZWhvdXNlU3RvcmUoeCwgbmF0dXJhbElkcykpO1xufSk7XG5cbmZ1bmN0aW9uIGlzVW5ib3VuZFdhcmVob3VzZVN0b3JlKHN0b3JlOiBQcnVuQXBpLlN0b3JlLCBzaXRlTmF0dXJhbElkczogU2V0PHN0cmluZz4pIHtcbiAgaWYgKHN0b3JlLnR5cGUgIT09ICdXQVJFSE9VU0VfU1RPUkUnKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgY29uc3Qgd2FyZWhvdXNlID0gd2FyZWhvdXNlc1N0b3JlLmdldEJ5SWQoc3RvcmUuYWRkcmVzc2FibGVJZCk7XG4gIGlmICghd2FyZWhvdXNlKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgY29uc3QgYWRkcmVzcyA9IHdhcmVob3VzZS5hZGRyZXNzO1xuICBpZiAoaXNTdGF0aW9uQWRkcmVzcyhhZGRyZXNzKSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBpZiAoIWlzUGxhbmV0QWRkcmVzcyhhZGRyZXNzKSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGNvbnN0IG5hdHVyYWxJZCA9IGdldEVudGl0eU5hdHVyYWxJZEZyb21BZGRyZXNzKGFkZHJlc3MpO1xuICByZXR1cm4gbmF0dXJhbElkID09PSB1bmRlZmluZWQgfHwgIXNpdGVOYXR1cmFsSWRzLmhhcyhuYXR1cmFsSWQpO1xufVxuXG5jb25zdCB1bmJvdW5kSW52ZW50b3J5ID0gY29tcHV0ZWQoKCkgPT4gc3VtU3RvcmVzVmFsdWUodW5ib3VuZFdhcmVob3VzZVN0b3Jlcy52YWx1ZSkpO1xuXG5jb25zdCBvdGhlckl0ZW1zID0gY29tcHV0ZWQoKCkgPT5cbiAgc3VtKGJhc2VJbnZlbnRvcnkudmFsdWU/Lm90aGVySXRlbXMsIHNoaXB5YXJkSW52ZW50b3J5LnZhbHVlLCB1bmJvdW5kSW52ZW50b3J5LnZhbHVlKSxcbik7XG5cbmNvbnN0IGZ1ZWxTdG9yZXMgPSBjb21wdXRlZCgoKSA9PiBzdG9yYWdlc1N0b3JlLmFsbC52YWx1ZT8uZmlsdGVyKGlzRnVlbFN0b3JlKSk7XG5cbmZ1bmN0aW9uIGlzRnVlbFN0b3JlKHN0b3JlOiBQcnVuQXBpLlN0b3JlKSB7XG4gIHJldHVybiBzdG9yZS50eXBlID09PSAnU1RMX0ZVRUxfU1RPUkUnIHx8IHN0b3JlLnR5cGUgPT09ICdGVExfRlVFTF9TVE9SRSc7XG59XG5cbmNvbnN0IGZ1ZWxUYW5rcyA9IGNvbXB1dGVkKCgpID0+IHN1bVN0b3Jlc1ZhbHVlKGZ1ZWxTdG9yZXMudmFsdWUpKTtcblxuY29uc3Qgc2hpcFN0b3JlcyA9IGNvbXB1dGVkKCgpID0+IHN0b3JhZ2VzU3RvcmUuYWxsLnZhbHVlPy5maWx0ZXIoaXNTaGlwU3RvcmUpKTtcblxuZnVuY3Rpb24gaXNTaGlwU3RvcmUoc3RvcmU6IFBydW5BcGkuU3RvcmUpIHtcbiAgcmV0dXJuIHN0b3JlLnR5cGUgPT09ICdTSElQX1NUT1JFJztcbn1cblxuY29uc3Qgc2hpcEludmVudG9yeSA9IGNvbXB1dGVkKCgpID0+IHN1bVN0b3Jlc1ZhbHVlKHNoaXBTdG9yZXMudmFsdWUpKTtcblxuY29uc3QgbWF0ZXJpYWxzSW5UcmFuc2l0ID0gY29tcHV0ZWQoKCkgPT5cbiAgc3VtKHNoaXBJbnZlbnRvcnkudmFsdWUsIHN1bVNoaXBtZW50RGVsaXZlcmllcyhwYXJ0bmVyQ3VycmVudENvbmRpdGlvbnMpKSxcbik7XG5cbmNvbnN0IG1hdGVyaWFsc1JlY2VpdmFibGUgPSBjb21wdXRlZCgoKSA9PlxuICBzdW0oc3VtRGVsaXZlcmllcyhwYXJ0bmVyQ3VycmVudENvbmRpdGlvbnMpLCBzdW1NYXRlcmlhbHNQaWNrdXAoc2VsZkN1cnJlbnRDb25kaXRpb25zKSksXG4pO1xuXG5leHBvcnQgY29uc3QgaW52ZW50b3J5ID0ge1xuICBieUxvY2F0aW9uLFxuICBjeExpc3RlZE1hdGVyaWFscyxcbiAgY3hJbnZlbnRvcnksXG4gIG1tTWF0ZXJpYWxzVG90YWwsXG4gIGN4SW52ZW50b3J5VG90YWwsXG4gIG1hdGVyaWFsc0luVHJhbnNpdCxcbiAgZmluaXNoZWRHb29kcyxcbiAgd29ya0luUHJvZ3Jlc3MsXG4gIHJhd01hdGVyaWFscyxcbiAgd29ya2ZvcmNlQ29uc3VtYWJsZXMsXG4gIG90aGVySXRlbXMsXG4gIGZ1ZWxUYW5rcyxcbiAgbWF0ZXJpYWxzUmVjZWl2YWJsZSxcbn07XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBbUNBLFNBQUEsU0FBQSxXQUFBO0FBQ0UsU0FBQSxNQUFBLFdBQUEsQ0FBQSxNQUFBLEVBQUEsS0FBQTtBQUNGO0FBRUEsU0FBQSxnQkFBQSxTQUFBO0FBQ0UsU0FBQSxTQUFBLE1BQUEsQ0FBQSxHQUFBLFNBQUE7QUFDRjtBQUVBLFNBQUEsaUJBQUEsU0FBQTtBQUNFLFNBQUEsU0FBQSxNQUFBLENBQUEsR0FBQSxTQUFBO0FBQ0Y7QUFFQSxNQUFBLHVCQUFBLFNBQUEsTUFBQTtBQUNFLFFBQUEsV0FBQSxjQUFBLElBQUE7QUFDQSxNQUFBLENBQUEsVUFBQTtBQUNFLFdBQUE7QUFBQSxFQUFPO0FBRVQsUUFBQSxjQUFBLG9CQUFBLElBQUE7QUFDQSxhQUFBLFdBQUEsVUFBQTtBQUNFLFVBQUEsWUFBQSxDQUFBO0FBQ0EsZUFBQSxRQUFBLFFBQUEsT0FBQTtBQUNFLFVBQUEsQ0FBQSxLQUFBLFVBQUE7QUFDRTtBQUFBLE1BQUE7QUFFRixZQUFBLFFBQUEsd0JBQUEsS0FBQSxRQUFBO0FBQ0EsVUFBQSxVQUFBLFFBQUE7QUFDRSxlQUFBO0FBQUEsTUFBTztBQUVULGdCQUFBLEtBQUE7QUFBQSxRQUFlLFVBQUEsS0FBQSxTQUFBO0FBQUEsUUFDVyxRQUFBLEtBQUEsU0FBQTtBQUFBLFFBQ0Y7QUFBQSxNQUN0QixDQUFBO0FBQUEsSUFDRDtBQUVILGdCQUFBLElBQUEsUUFBQSxJQUFBLFNBQUE7QUFBQSxFQUFxQztBQUV2QyxTQUFBO0FBQ0YsQ0FBQTtBQUVBLFNBQUEsZUFBQSxRQUFBO0FBQ0UsUUFBQSxjQUFBLHFCQUFBO0FBQ0EsTUFBQSxDQUFBLGVBQUEsQ0FBQSxRQUFBO0FBQ0UsV0FBQTtBQUFBLEVBQU87QUFFVCxNQUFBLFFBQUE7QUFDQSxhQUFBLFNBQUEsUUFBQTtBQUNFLFVBQUEsUUFBQSxTQUFBLFlBQUEsSUFBQSxNQUFBLEVBQUEsQ0FBQTtBQUNBLFFBQUEsVUFBQSxRQUFBO0FBQ0UsYUFBQTtBQUFBLElBQU87QUFFVCxhQUFBO0FBQUEsRUFBUztBQUVYLFNBQUE7QUFDRjtBQUVBLE1BQUEsOEJBQUEsU0FBQSxNQUFBO0FBQ0UsUUFBQSxXQUFBLHNCQUFBLElBQUE7QUFDQSxNQUFBLENBQUEsVUFBQTtBQUNFLFdBQUE7QUFBQSxFQUFPO0FBRVQsUUFBQSxjQUFBLG9CQUFBLElBQUE7QUFDQSxhQUFBLFdBQUEsU0FBQSxPQUFBLENBQUEsTUFBQSxFQUFBLFdBQUEsU0FBQSxHQUFBO0FBQ0UsVUFBQSxRQUFBLHVCQUFBLFFBQUEsVUFBQSxLQUFBO0FBQ0EsUUFBQSxVQUFBLFFBQUE7QUFDRSxhQUFBO0FBQUEsSUFBTztBQUdULFVBQUEsV0FBQSxlQUFBLFFBQUEsUUFBQSxVQUFBO0FBQ0EsUUFBQSxDQUFBLFVBQUE7QUFDRTtBQUFBLElBQUE7QUFHRixVQUFBLE9BQUEseUJBQUEsU0FBQSxPQUFBO0FBQ0EsZ0JBQUEsSUFBQSxPQUFBLFlBQUEsSUFBQSxJQUFBLEtBQUEsS0FBQSxLQUFBO0FBQUEsRUFBMEQ7QUFFNUQsU0FBQTtBQUNGLENBQUE7QUFFQSxNQUFBLG9CQUFBLFNBQUEsTUFBQSxhQUFBLDRCQUFBLEtBQUEsQ0FBQTtBQUVBLE1BQUEsYUFBQSxTQUFBLE1BQUE7QUFDRSxRQUFBLGNBQUEscUJBQUE7QUFDQSxRQUFBLFdBQUEsY0FBQSxJQUFBO0FBQ0EsUUFBQSxZQUFBLDRCQUFBO0FBQ0EsTUFBQSxDQUFBLGVBQUEsQ0FBQSxZQUFBLENBQUEsV0FBQTtBQUNFLFdBQUE7QUFBQSxFQUFPO0FBRVQsUUFBQSxjQUFBLG9CQUFBLElBQUE7QUFDQSxhQUFBLFNBQUEsVUFBQTtBQUNFLFVBQUEsYUFBQSxTQUFBLFlBQUEsSUFBQSxN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
