import { sitesStore, getBuildingLastRepair } from './sites.js';
import { shipsStore, getShipLastRepair } from './ships.js';
import { getEntityNameFromAddress, getEntityNaturalIdFromAddress } from './addresses.js';
import { isRepairableBuilding, getBuildingBuildMaterials } from './buildings.js';
import { isEmpty } from './is-empty.js';
function getParameterSites(parameters) {
  let sites = [];
  if (isEmpty(parameters)) {
    if (sitesStore.all.value === void 0) {
      return void 0;
    }
    sites = sitesStore.all.value;
  }
  for (let i = 0; i < parameters.length; i++) {
    const site = sitesStore.getByPlanetNaturalIdOrName(parameters[i]);
    if (site) {
      sites.push(site);
    }
  }
  return sites;
}
function calculateBuildingEntries(sites) {
  if (!sites) {
    return void 0;
  }
  const entries = [];
  for (const site of sites) {
    const target = getEntityNameFromAddress(site.address);
    const naturalId = getEntityNaturalIdFromAddress(site.address);
    for (const building of site.platforms.filter(isRepairableBuilding)) {
      entries.push({
        ticker: building.module.reactorTicker,
        target,
        naturalId,
        lastRepair: getBuildingLastRepair(building),
        condition: building.condition,
        materials: building.repairMaterials,
        fullMaterials: getBuildingBuildMaterials(building, site),
      });
    }
  }
  entries.sort((a, b) => a.condition - b.condition);
  return entries;
}
function getParameterShips(parameters) {
  let ships = [];
  if (parameters.length === 0 || parameters.some(isShipParameter)) {
    if (shipsStore.all.value === void 0) {
      return void 0;
    }
    ships = shipsStore.all.value;
  }
  return ships;
}
function calculateShipEntries(ships) {
  if (!ships) {
    return void 0;
  }
  const entries = [];
  for (const ship of ships) {
    entries.push({
      ticker: ship.name,
      target: ship.name,
      naturalId: 'SHIP',
      lastRepair: getShipLastRepair(ship),
      condition: ship.condition,
      materials: ship.repairMaterials,
      fullMaterials: ship.repairMaterials,
    });
  }
  entries.sort((a, b) => a.condition - b.condition);
  return entries;
}
function isShipParameter(parameter) {
  const upper = parameter.toUpperCase();
  return upper === 'SHIP' || upper === 'SHIPS';
}
export { calculateBuildingEntries, calculateShipEntries, getParameterShips, getParameterSites };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW50cmllcy5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2ZlYXR1cmVzL1hJVC9SRVAvZW50cmllcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRCdWlsZGluZ0xhc3RSZXBhaXIsIHNpdGVzU3RvcmUgfSBmcm9tICdAc3JjL2luZnJhc3RydWN0dXJlL3BydW4tYXBpL2RhdGEvc2l0ZXMnO1xuaW1wb3J0IHsgZ2V0U2hpcExhc3RSZXBhaXIsIHNoaXBzU3RvcmUgfSBmcm9tICdAc3JjL2luZnJhc3RydWN0dXJlL3BydW4tYXBpL2RhdGEvc2hpcHMnO1xuaW1wb3J0IHtcbiAgZ2V0RW50aXR5TmFtZUZyb21BZGRyZXNzLFxuICBnZXRFbnRpdHlOYXR1cmFsSWRGcm9tQWRkcmVzcyxcbn0gZnJvbSAnQHNyYy9pbmZyYXN0cnVjdHVyZS9wcnVuLWFwaS9kYXRhL2FkZHJlc3Nlcyc7XG5pbXBvcnQgeyBnZXRCdWlsZGluZ0J1aWxkTWF0ZXJpYWxzLCBpc1JlcGFpcmFibGVCdWlsZGluZyB9IGZyb20gJ0BzcmMvY29yZS9idWlsZGluZ3MnO1xuaW1wb3J0IHsgaXNFbXB0eSB9IGZyb20gJ3RzLWV4dHJhcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVwYWlyRW50cnkge1xuICB0aWNrZXI6IHN0cmluZztcbiAgdGFyZ2V0OiBzdHJpbmc7XG4gIG5hdHVyYWxJZDogc3RyaW5nO1xuICBsYXN0UmVwYWlyOiBudW1iZXI7XG4gIGNvbmRpdGlvbjogbnVtYmVyO1xuICBtYXRlcmlhbHM6IFBydW5BcGkuTWF0ZXJpYWxBbW91bnRbXTtcbiAgZnVsbE1hdGVyaWFsczogUHJ1bkFwaS5NYXRlcmlhbEFtb3VudFtdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGFyYW1ldGVyU2l0ZXMocGFyYW1ldGVyczogc3RyaW5nW10pIHtcbiAgbGV0IHNpdGVzOiBQcnVuQXBpLlNpdGVbXSA9IFtdO1xuICBpZiAoaXNFbXB0eShwYXJhbWV0ZXJzKSkge1xuICAgIGlmIChzaXRlc1N0b3JlLmFsbC52YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBzaXRlcyA9IHNpdGVzU3RvcmUuYWxsLnZhbHVlO1xuICB9XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgcGFyYW1ldGVycy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHNpdGUgPSBzaXRlc1N0b3JlLmdldEJ5UGxhbmV0TmF0dXJhbElkT3JOYW1lKHBhcmFtZXRlcnNbaV0pO1xuICAgIGlmIChzaXRlKSB7XG4gICAgICBzaXRlcy5wdXNoKHNpdGUpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gc2l0ZXM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWxjdWxhdGVCdWlsZGluZ0VudHJpZXMoc2l0ZXM/OiBQcnVuQXBpLlNpdGVbXSkge1xuICBpZiAoIXNpdGVzKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICBjb25zdCBlbnRyaWVzOiBSZXBhaXJFbnRyeVtdID0gW107XG4gIGZvciAoY29uc3Qgc2l0ZSBvZiBzaXRlcykge1xuICAgIGNvbnN0IHRhcmdldCA9IGdldEVudGl0eU5hbWVGcm9tQWRkcmVzcyhzaXRlLmFkZHJlc3MpITtcbiAgICBjb25zdCBuYXR1cmFsSWQgPSBnZXRFbnRpdHlOYXR1cmFsSWRGcm9tQWRkcmVzcyhzaXRlLmFkZHJlc3MpITtcbiAgICBmb3IgKGNvbnN0IGJ1aWxkaW5nIG9mIHNpdGUucGxhdGZvcm1zLmZpbHRlcihpc1JlcGFpcmFibGVCdWlsZGluZykpIHtcbiAgICAgIGVudHJpZXMucHVzaCh7XG4gICAgICAgIHRpY2tlcjogYnVpbGRpbmcubW9kdWxlLnJlYWN0b3JUaWNrZXIsXG4gICAgICAgIHRhcmdldCxcbiAgICAgICAgbmF0dXJhbElkLFxuICAgICAgICBsYXN0UmVwYWlyOiBnZXRCdWlsZGluZ0xhc3RSZXBhaXIoYnVpbGRpbmcpLFxuICAgICAgICBjb25kaXRpb246IGJ1aWxkaW5nLmNvbmRpdGlvbixcbiAgICAgICAgbWF0ZXJpYWxzOiBidWlsZGluZy5yZXBhaXJNYXRlcmlhbHMsXG4gICAgICAgIGZ1bGxNYXRlcmlhbHM6IGdldEJ1aWxkaW5nQnVpbGRNYXRlcmlhbHMoYnVpbGRpbmcsIHNpdGUpLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIGVudHJpZXMuc29ydCgoYSwgYikgPT4gYS5jb25kaXRpb24gLSBiLmNvbmRpdGlvbik7XG4gIHJldHVybiBlbnRyaWVzO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGFyYW1ldGVyU2hpcHMocGFyYW1ldGVyczogc3RyaW5nW10pIHtcbiAgbGV0IHNoaXBzOiBQcnVuQXBpLlNoaXBbXSA9IFtdO1xuICBpZiAocGFyYW1ldGVycy5sZW5ndGggPT09IDAgfHwgcGFyYW1ldGVycy5zb21lKGlzU2hpcFBhcmFtZXRlcikpIHtcbiAgICBpZiAoc2hpcHNTdG9yZS5hbGwudmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgc2hpcHMgPSBzaGlwc1N0b3JlLmFsbC52YWx1ZTtcbiAgfVxuICByZXR1cm4gc2hpcHM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWxjdWxhdGVTaGlwRW50cmllcyhzaGlwcz86IFBydW5BcGkuU2hpcFtdKSB7XG4gIGlmICghc2hpcHMpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG4gIGNvbnN0IGVudHJpZXM6IFJlcGFpckVudHJ5W10gPSBbXTtcbiAgZm9yIChjb25zdCBzaGlwIG9mIHNoaXBzKSB7XG4gICAgZW50cmllcy5wdXNoKHtcbiAgICAgIHRpY2tlcjogc2hpcC5uYW1lLFxuICAgICAgdGFyZ2V0OiBzaGlwLm5hbWUsXG4gICAgICBuYXR1cmFsSWQ6ICdTSElQJyxcbiAgICAgIGxhc3RSZXBhaXI6IGdldFNoaXBMYXN0UmVwYWlyKHNoaXApLFxuICAgICAgY29uZGl0aW9uOiBzaGlwLmNvbmRpdGlvbixcbiAgICAgIG1hdGVyaWFsczogc2hpcC5yZXBhaXJNYXRlcmlhbHMsXG4gICAgICBmdWxsTWF0ZXJpYWxzOiBzaGlwLnJlcGFpck1hdGVyaWFscyxcbiAgICB9KTtcbiAgfVxuICBlbnRyaWVzLnNvcnQoKGEsIGIpID0+IGEuY29uZGl0aW9uIC0gYi5jb25kaXRpb24pO1xuICByZXR1cm4gZW50cmllcztcbn1cblxuZnVuY3Rpb24gaXNTaGlwUGFyYW1ldGVyKHBhcmFtZXRlcjogc3RyaW5nKSB7XG4gIGNvbnN0IHVwcGVyID0gcGFyYW1ldGVyLnRvVXBwZXJDYXNlKCk7XG4gIHJldHVybiB1cHBlciA9PT0gJ1NISVAnIHx8IHVwcGVyID09PSAnU0hJUFMnO1xufVxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBbUJPLFNBQVMsa0JBQWtCLFlBQXNCO0FBQ3RELE1BQUksUUFBd0IsQ0FBQTtBQUM1QixNQUFJLFFBQVEsVUFBVSxHQUFHO0FBQ3ZCLFFBQUksV0FBVyxJQUFJLFVBQVUsUUFBVztBQUN0QyxhQUFPO0FBQUEsSUFDVDtBQUNBLFlBQVEsV0FBVyxJQUFJO0FBQUEsRUFDekI7QUFDQSxXQUFTLElBQUksR0FBRyxJQUFJLFdBQVcsUUFBUSxLQUFLO0FBQzFDLFVBQU0sT0FBTyxXQUFXLDJCQUEyQixXQUFXLENBQUMsQ0FBQztBQUNoRSxRQUFJLE1BQU07QUFDUixZQUFNLEtBQUssSUFBSTtBQUFBLElBQ2pCO0FBQUEsRUFDRjtBQUNBLFNBQU87QUFDVDtBQUVPLFNBQVMseUJBQXlCLE9BQXdCO0FBQy9ELE1BQUksQ0FBQyxPQUFPO0FBQ1YsV0FBTztBQUFBLEVBQ1Q7QUFDQSxRQUFNLFVBQXlCLENBQUE7QUFDL0IsYUFBVyxRQUFRLE9BQU87QUFDeEIsVUFBTSxTQUFTLHlCQUF5QixLQUFLLE9BQU87QUFDcEQsVUFBTSxZQUFZLDhCQUE4QixLQUFLLE9BQU87QUFDNUQsZUFBVyxZQUFZLEtBQUssVUFBVSxPQUFPLG9CQUFvQixHQUFHO0FBQ2xFLGNBQVEsS0FBSztBQUFBLFFBQ1gsUUFBUSxTQUFTLE9BQU87QUFBQSxRQUN4QjtBQUFBLFFBQ0E7QUFBQSxRQUNBLFlBQVksc0JBQXNCLFFBQVE7QUFBQSxRQUMxQyxXQUFXLFNBQVM7QUFBQSxRQUNwQixXQUFXLFNBQVM7QUFBQSxRQUNwQixlQUFlLDBCQUEwQixVQUFVLElBQUk7QUFBQSxNQUFBLENBQ3hEO0FBQUEsSUFDSDtBQUFBLEVBQ0Y7QUFDQSxVQUFRLEtBQUssQ0FBQyxHQUFHLE1BQU0sRUFBRSxZQUFZLEVBQUUsU0FBUztBQUNoRCxTQUFPO0FBQ1Q7QUFFTyxTQUFTLGtCQUFrQixZQUFzQjtBQUN0RCxNQUFJLFFBQXdCLENBQUE7QUFDNUIsTUFBSSxXQUFXLFdBQVcsS0FBSyxXQUFXLEtBQUssZUFBZSxHQUFHO0FBQy9ELFFBQUksV0FBVyxJQUFJLFVBQVUsUUFBVztBQUN0QyxhQUFPO0FBQUEsSUFDVDtBQUNBLFlBQVEsV0FBVyxJQUFJO0FBQUEsRUFDekI7QUFDQSxTQUFPO0FBQ1Q7QUFFTyxTQUFTLHFCQUFxQixPQUF3QjtBQUMzRCxNQUFJLENBQUMsT0FBTztBQUNWLFdBQU87QUFBQSxFQUNUO0FBQ0EsUUFBTSxVQUF5QixDQUFBO0FBQy9CLGFBQVcsUUFBUSxPQUFPO0FBQ3hCLFlBQVEsS0FBSztBQUFBLE1BQ1gsUUFBUSxLQUFLO0FBQUEsTUFDYixRQUFRLEtBQUs7QUFBQSxNQUNiLFdBQVc7QUFBQSxNQUNYLFlBQVksa0JBQWtCLElBQUk7QUFBQSxNQUNsQyxXQUFXLEtBQUs7QUFBQSxNQUNoQixXQUFXLEtBQUs7QUFBQSxNQUNoQixlQUFlLEtBQUs7QUFBQSxJQUFBLENBQ3JCO0FBQUEsRUFDSDtBQUNBLFVBQVEsS0FBSyxDQUFDLEdBQUcsTUFBTSxFQUFFLFlBQVksRUFBRSxTQUFTO0FBQ2hELFNBQU87QUFDVDtBQUVBLFNBQVMsZ0JBQWdCLFdBQW1CO0FBQzFDLFFBQU0sUUFBUSxVQUFVLFlBQUE7QUFDeEIsU0FBTyxVQUFVLFVBQVUsVUFBVTtBQUN2QzsifQ==
