import { map } from './map-values.js';
import { sum } from './sum.js';
function calcSectionTotal(section, ...args) {
  if (section === void 0) {
    return void 0;
  }
  if (section.total !== void 0) {
    return section.total;
  }
  return section.total ?? mapSum(...args.map(x => x(section)));
}
function less(value) {
  return value !== void 0 ? -value : value;
}
function calcTotalDeposits(sheet) {
  return calcSectionTotal(
    sheet.assets?.current?.cashAndCashEquivalents?.deposits,
    x => x.cx,
    x => x.fx,
  );
}
function calcTotalCashAndCashEquivalents(sheet) {
  return calcSectionTotal(
    sheet.assets?.current?.cashAndCashEquivalents,
    x => x.cash,
    () => calcTotalDeposits(sheet),
    x => x.mmMaterials,
  );
}
function calcTotalLoansReceivable(sheet) {
  return calcSectionTotal(
    sheet.assets?.current?.loansReceivable,
    x => x.principal,
    x => x.interest,
  );
}
function calcTotalBaseInventory(sheet) {
  return calcSectionTotal(
    sheet.assets?.current?.inventory?.baseInventory,
    x => x.finishedGoods,
    x => x.workInProgress,
    x => x.rawMaterials,
    x => x.workforceConsumables,
    x => x.otherItems,
  );
}
function calcTotalInventory(sheet) {
  return calcSectionTotal(
    sheet.assets?.current?.inventory,
    x => x.cxListedMaterials,
    x => x.cxInventory,
    x => x.materialsInTransit,
    () => calcTotalBaseInventory(sheet),
    x => x.fuelTanks,
    x => x.materialsReceivable,
  );
}
function calcTotalCurrentAssets(sheet) {
  return calcSectionTotal(
    sheet.assets?.current,
    () => calcTotalCashAndCashEquivalents(sheet),
    x => x.accountsReceivable,
    () => calcTotalLoansReceivable(sheet),
    () => calcTotalInventory(sheet),
  );
}
function calcTotalBuildingsMarketValue(sheet) {
  return calcSectionTotal(
    sheet.assets?.nonCurrent?.buildings?.marketValue,
    x => x.infrastructure,
    x => x.resourceExtraction,
    x => x.production,
  );
}
function calcTotalBuildings(sheet) {
  return calcSectionTotal(
    sheet.assets?.nonCurrent?.buildings,
    () => calcTotalBuildingsMarketValue(sheet),
    x => less(x.accumulatedDepreciation),
  );
}
function calcTotalShips(sheet) {
  return calcSectionTotal(
    sheet.assets?.nonCurrent?.ships,
    x => x.marketValue,
    x => less(x.accumulatedDepreciation),
  );
}
function calcTotalLongTermReceivables(sheet) {
  return calcSectionTotal(
    sheet.assets?.nonCurrent?.longTermReceivables,
    x => x.accountsReceivable,
    x => x.materialsInTransit,
    x => x.materialsReceivable,
    x => x.loansPrincipal,
  );
}
function calcTotalIntangibleAssets(sheet) {
  return calcSectionTotal(
    sheet.assets?.nonCurrent?.intangibleAssets,
    x => x.hqUpgrades,
    x => x.arc,
  );
}
function calcTotalNonCurrentAssets(sheet) {
  return calcSectionTotal(
    sheet.assets?.nonCurrent,
    () => calcTotalBuildings(sheet),
    () => calcTotalShips(sheet),
    () => calcTotalLongTermReceivables(sheet),
    () => calcTotalIntangibleAssets(sheet),
  );
}
function calcTotalAssets(sheet) {
  return calcSectionTotal(
    sheet.assets,
    () => calcTotalCurrentAssets(sheet),
    () => calcTotalNonCurrentAssets(sheet),
  );
}
function calcTotalLoansPayable(sheet) {
  return calcSectionTotal(
    sheet.liabilities?.current?.loansPayable,
    x => x.principal,
    x => x.interest,
  );
}
function calcTotalCurrentLiabilities(sheet) {
  return calcSectionTotal(
    sheet.liabilities?.current,
    x => x.accountsPayable,
    x => x.materialsPayable,
    () => calcTotalLoansPayable(sheet),
  );
}
function calcTotalLongTermPayables(sheet) {
  return calcSectionTotal(
    sheet.liabilities?.nonCurrent?.longTermPayables,
    x => x.accountsPayable,
    x => x.materialsPayable,
    x => x.loansPrincipal,
  );
}
function calcTotalNonCurrentLiabilities(sheet) {
  return calcSectionTotal(sheet.liabilities?.nonCurrent, () => calcTotalLongTermPayables(sheet));
}
function calcTotalLiabilities(sheet) {
  return calcSectionTotal(
    sheet.liabilities,
    () => calcTotalCurrentLiabilities(sheet),
    () => calcTotalNonCurrentLiabilities(sheet),
  );
}
function calcEquity(sheet) {
  return sheet.equity ?? mapSum(calcTotalAssets(sheet), less(calcTotalLiabilities(sheet)));
}
function calcLiquidationValue(sheet) {
  return mapSum(
    calcEquity(sheet),
    less(calcTotalShips(sheet)),
    less(calcTotalIntangibleAssets(sheet)),
  );
}
function calcQuickAssets(sheet) {
  return mapSum(
    calcTotalCashAndCashEquivalents(sheet),
    calcTotalLoansReceivable(sheet),
    sheet?.assets?.current?.accountsReceivable,
  );
}
function calcQuickLiabilities(sheet) {
  return mapSum(calcTotalLoansPayable(sheet), sheet?.liabilities?.current?.accountsPayable);
}
function calcAcidTestRatio(sheet) {
  return map([calcQuickAssets(sheet), calcQuickLiabilities(sheet)], (x, y) => x / y);
}
function calcDebtRatio(sheet) {
  return map([calcTotalLiabilities(sheet), calcTotalAssets(sheet)], (x, y) => x / y);
}
function mapSum(...args) {
  return map(args, sum);
}
export {
  calcAcidTestRatio,
  calcDebtRatio,
  calcEquity,
  calcLiquidationValue,
  calcQuickAssets,
  calcQuickLiabilities,
  calcTotalAssets,
  calcTotalBaseInventory,
  calcTotalBuildings,
  calcTotalBuildingsMarketValue,
  calcTotalCashAndCashEquivalents,
  calcTotalCurrentAssets,
  calcTotalCurrentLiabilities,
  calcTotalDeposits,
  calcTotalIntangibleAssets,
  calcTotalInventory,
  calcTotalLiabilities,
  calcTotalLoansPayable,
  calcTotalLoansReceivable,
  calcTotalLongTermPayables,
  calcTotalLongTermReceivables,
  calcTotalNonCurrentAssets,
  calcTotalNonCurrentLiabilities,
  calcTotalShips,
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFsYW5jZS1zaGVldC1zdW1tYXJ5LmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29yZS9iYWxhbmNlL2JhbGFuY2Utc2hlZXQtc3VtbWFyeS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYXJ0aWFsQmFsYW5jZVNoZWV0IH0gZnJvbSAnQHNyYy9jb3JlL2JhbGFuY2UvYmFsYW5jZS1zaGVldCc7XG5pbXBvcnQgeyBtYXAgfSBmcm9tICdAc3JjL3V0aWxzL21hcC12YWx1ZXMnO1xuaW1wb3J0IHsgc3VtIH0gZnJvbSAnQHNyYy91dGlscy9zdW0nO1xuXG5pbnRlcmZhY2UgQmFsYW5jZVNoZWV0U2VjdGlvbiB7XG4gIFtrZXk6IHN0cmluZ106IEJhbGFuY2VTaGVldFNlY3Rpb24gfCBudW1iZXIgfCB1bmRlZmluZWQ7XG5cbiAgdG90YWw/OiBudW1iZXI7XG59XG5cbmZ1bmN0aW9uIGNhbGNTZWN0aW9uVG90YWw8VCBleHRlbmRzIEJhbGFuY2VTaGVldFNlY3Rpb24+KFxuICBzZWN0aW9uPzogVCxcbiAgLi4uYXJnczogKChzZWN0aW9uOiBUKSA9PiBudW1iZXIgfCB1bmRlZmluZWQpW11cbikge1xuICBpZiAoc2VjdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIGlmIChzZWN0aW9uLnRvdGFsICE9PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gc2VjdGlvbi50b3RhbDtcbiAgfVxuXG4gIHJldHVybiBzZWN0aW9uLnRvdGFsID8/IG1hcFN1bSguLi5hcmdzLm1hcCh4ID0+IHgoc2VjdGlvbikpKTtcbn1cblxuZnVuY3Rpb24gbGVzcyh2YWx1ZTogbnVtYmVyIHwgdW5kZWZpbmVkKSB7XG4gIHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gLXZhbHVlIDogdmFsdWU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWxjVG90YWxEZXBvc2l0cyhzaGVldDogUGFydGlhbEJhbGFuY2VTaGVldCkge1xuICByZXR1cm4gY2FsY1NlY3Rpb25Ub3RhbChcbiAgICBzaGVldC5hc3NldHM/LmN1cnJlbnQ/LmNhc2hBbmRDYXNoRXF1aXZhbGVudHM/LmRlcG9zaXRzLFxuICAgIHggPT4geC5jeCxcbiAgICB4ID0+IHguZngsXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWxjVG90YWxDYXNoQW5kQ2FzaEVxdWl2YWxlbnRzKHNoZWV0OiBQYXJ0aWFsQmFsYW5jZVNoZWV0KSB7XG4gIHJldHVybiBjYWxjU2VjdGlvblRvdGFsKFxuICAgIHNoZWV0LmFzc2V0cz8uY3VycmVudD8uY2FzaEFuZENhc2hFcXVpdmFsZW50cyxcbiAgICB4ID0+IHguY2FzaCxcbiAgICAoKSA9PiBjYWxjVG90YWxEZXBvc2l0cyhzaGVldCksXG4gICAgeCA9PiB4Lm1tTWF0ZXJpYWxzLFxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2FsY1RvdGFsTG9hbnNSZWNlaXZhYmxlKHNoZWV0OiBQYXJ0aWFsQmFsYW5jZVNoZWV0KSB7XG4gIHJldHVybiBjYWxjU2VjdGlvblRvdGFsKFxuICAgIHNoZWV0LmFzc2V0cz8uY3VycmVudD8ubG9hbnNSZWNlaXZhYmxlLFxuICAgIHggPT4geC5wcmluY2lwYWwsXG4gICAgeCA9PiB4LmludGVyZXN0LFxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2FsY1RvdGFsQmFzZUludmVudG9yeShzaGVldDogUGFydGlhbEJhbGFuY2VTaGVldCkge1xuICByZXR1cm4gY2FsY1NlY3Rpb25Ub3RhbChcbiAgICBzaGVldC5hc3NldHM/LmN1cnJlbnQ/LmludmVudG9yeT8uYmFzZUludmVudG9yeSxcbiAgICB4ID0+IHguZmluaXNoZWRHb29kcyxcbiAgICB4ID0+IHgud29ya0luUHJvZ3Jlc3MsXG4gICAgeCA9PiB4LnJhd01hdGVyaWFscyxcbiAgICB4ID0+IHgud29ya2ZvcmNlQ29uc3VtYWJsZXMsXG4gICAgeCA9PiB4Lm90aGVySXRlbXMsXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWxjVG90YWxJbnZlbnRvcnkoc2hlZXQ6IFBhcnRpYWxCYWxhbmNlU2hlZXQpIHtcbiAgcmV0dXJuIGNhbGNTZWN0aW9uVG90YWwoXG4gICAgc2hlZXQuYXNzZXRzPy5jdXJyZW50Py5pbnZlbnRvcnksXG4gICAgeCA9PiB4LmN4TGlzdGVkTWF0ZXJpYWxzLFxuICAgIHggPT4geC5jeEludmVudG9yeSxcbiAgICB4ID0+IHgubWF0ZXJpYWxzSW5UcmFuc2l0LFxuICAgICgpID0+IGNhbGNUb3RhbEJhc2VJbnZlbnRvcnkoc2hlZXQpLFxuICAgIHggPT4geC5mdWVsVGFua3MsXG4gICAgeCA9PiB4Lm1hdGVyaWFsc1JlY2VpdmFibGUsXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWxjVG90YWxDdXJyZW50QXNzZXRzKHNoZWV0OiBQYXJ0aWFsQmFsYW5jZVNoZWV0KSB7XG4gIHJldHVybiBjYWxjU2VjdGlvblRvdGFsKFxuICAgIHNoZWV0LmFzc2V0cz8uY3VycmVudCxcbiAgICAoKSA9PiBjYWxjVG90YWxDYXNoQW5kQ2FzaEVxdWl2YWxlbnRzKHNoZWV0KSxcbiAgICB4ID0+IHguYWNjb3VudHNSZWNlaXZhYmxlLFxuICAgICgpID0+IGNhbGNUb3RhbExvYW5zUmVjZWl2YWJsZShzaGVldCksXG4gICAgKCkgPT4gY2FsY1RvdGFsSW52ZW50b3J5KHNoZWV0KSxcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhbGNUb3RhbEJ1aWxkaW5nc01hcmtldFZhbHVlKHNoZWV0OiBQYXJ0aWFsQmFsYW5jZVNoZWV0KSB7XG4gIHJldHVybiBjYWxjU2VjdGlvblRvdGFsKFxuICAgIHNoZWV0LmFzc2V0cz8ubm9uQ3VycmVudD8uYnVpbGRpbmdzPy5tYXJrZXRWYWx1ZSxcbiAgICB4ID0+IHguaW5mcmFzdHJ1Y3R1cmUsXG4gICAgeCA9PiB4LnJlc291cmNlRXh0cmFjdGlvbixcbiAgICB4ID0+IHgucHJvZHVjdGlvbixcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhbGNUb3RhbEJ1aWxkaW5ncyhzaGVldDogUGFydGlhbEJhbGFuY2VTaGVldCkge1xuICByZXR1cm4gY2FsY1NlY3Rpb25Ub3RhbChcbiAgICBzaGVldC5hc3NldHM/Lm5vbkN1cnJlbnQ/LmJ1aWxkaW5ncyxcbiAgICAoKSA9PiBjYWxjVG90YWxCdWlsZGluZ3NNYXJrZXRWYWx1ZShzaGVldCksXG4gICAgeCA9PiBsZXNzKHguYWNjdW11bGF0ZWREZXByZWNpYXRpb24pLFxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2FsY1RvdGFsU2hpcHMoc2hlZXQ6IFBhcnRpYWxCYWxhbmNlU2hlZXQpIHtcbiAgcmV0dXJuIGNhbGNTZWN0aW9uVG90YWwoXG4gICAgc2hlZXQuYXNzZXRzPy5ub25DdXJyZW50Py5zaGlwcyxcbiAgICB4ID0+IHgubWFya2V0VmFsdWUsXG4gICAgeCA9PiBsZXNzKHguYWNjdW11bGF0ZWREZXByZWNpYXRpb24pLFxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2FsY1RvdGFsTG9uZ1Rlcm1SZWNlaXZhYmxlcyhzaGVldDogUGFydGlhbEJhbGFuY2VTaGVldCkge1xuICByZXR1cm4gY2FsY1NlY3Rpb25Ub3RhbChcbiAgICBzaGVldC5hc3NldHM/Lm5vbkN1cnJlbnQ/LmxvbmdUZXJtUmVjZWl2YWJsZXMsXG4gICAgeCA9PiB4LmFjY291bnRzUmVjZWl2YWJsZSxcbiAgICB4ID0+IHgubWF0ZXJpYWxzSW5UcmFuc2l0LFxuICAgIHggPT4geC5tYXRlcmlhbHNSZWNlaXZhYmxlLFxuICAgIHggPT4geC5sb2Fuc1ByaW5jaXBhbCxcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhbGNUb3RhbEludGFuZ2libGVBc3NldHMoc2hlZXQ6IFBhcnRpYWxCYWxhbmNlU2hlZXQpIHtcbiAgcmV0dXJuIGNhbGNTZWN0aW9uVG90YWwoXG4gICAgc2hlZXQuYXNzZXRzPy5ub25DdXJyZW50Py5pbnRhbmdpYmxlQXNzZXRzLFxuICAgIHggPT4geC5ocVVwZ3JhZGVzLFxuICAgIHggPT4geC5hcmMsXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWxjVG90YWxOb25DdXJyZW50QXNzZXRzKHNoZWV0OiBQYXJ0aWFsQmFsYW5jZVNoZWV0KSB7XG4gIHJldHVybiBjYWxjU2VjdGlvblRvdGFsKFxuICAgIHNoZWV0LmFzc2V0cz8ubm9uQ3VycmVudCxcbiAgICAoKSA9PiBjYWxjVG90YWxCdWlsZGluZ3Moc2hlZXQpLFxuICAgICgpID0+IGNhbGNUb3RhbFNoaXBzKHNoZWV0KSxcbiAgICAoKSA9PiBjYWxjVG90YWxMb25nVGVybVJlY2VpdmFibGVzKHNoZWV0KSxcbiAgICAoKSA9PiBjYWxjVG90YWxJbnRhbmdpYmxlQXNzZXRzKHNoZWV0KSxcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhbGNUb3RhbEFzc2V0cyhzaGVldDogUGFydGlhbEJhbGFuY2VTaGVldCkge1xuICByZXR1cm4gY2FsY1NlY3Rpb25Ub3RhbChcbiAgICBzaGVldC5hc3NldHMsXG4gICAgKCkgPT4gY2FsY1RvdGFsQ3VycmVudEFzc2V0cyhzaGVldCksXG4gICAgKCkgPT4gY2FsY1RvdGFsTm9uQ3VycmVudEFzc2V0cyhzaGVldCksXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWxjVG90YWxMb2Fuc1BheWFibGUoc2hlZXQ6IFBhcnRpYWxCYWxhbmNlU2hlZXQpIHtcbiAgcmV0dXJuIGNhbGNTZWN0aW9uVG90YWwoXG4gICAgc2hlZXQubGlhYmlsaXRpZXM/LmN1cnJlbnQ/LmxvYW5zUGF5YWJsZSxcbiAgICB4ID0+IHgucHJpbmNpcGFsLFxuICAgIHggPT4geC5pbnRlcmVzdCxcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhbGNUb3RhbEN1cnJlbnRMaWFiaWxpdGllcyhzaGVldDogUGFydGlhbEJhbGFuY2VTaGVldCkge1xuICByZXR1cm4gY2FsY1NlY3Rpb25Ub3RhbChcbiAgICBzaGVldC5saWFiaWxpdGllcz8uY3VycmVudCxcbiAgICB4ID0+IHguYWNjb3VudHNQYXlhYmxlLFxuICAgIHggPT4geC5tYXRlcmlhbHNQYXlhYmxlLFxuICAgICgpID0+IGNhbGNUb3RhbExvYW5zUGF5YWJsZShzaGVldCksXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWxjVG90YWxMb25nVGVybVBheWFibGVzKHNoZWV0OiBQYXJ0aWFsQmFsYW5jZVNoZWV0KSB7XG4gIHJldHVybiBjYWxjU2VjdGlvblRvdGFsKFxuICAgIHNoZWV0LmxpYWJpbGl0aWVzPy5ub25DdXJyZW50Py5sb25nVGVybVBheWFibGVzLFxuICAgIHggPT4geC5hY2NvdW50c1BheWFibGUsXG4gICAgeCA9PiB4Lm1hdGVyaWFsc1BheWFibGUsXG4gICAgeCA9PiB4LmxvYW5zUHJpbmNpcGFsLFxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2FsY1RvdGFsTm9uQ3VycmVudExpYWJpbGl0aWVzKHNoZWV0OiBQYXJ0aWFsQmFsYW5jZVNoZWV0KSB7XG4gIHJldHVybiBjYWxjU2VjdGlvblRvdGFsKHNoZWV0LmxpYWJpbGl0aWVzPy5ub25DdXJyZW50LCAoKSA9PiBjYWxjVG90YWxMb25nVGVybVBheWFibGVzKHNoZWV0KSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWxjVG90YWxMaWFiaWxpdGllcyhzaGVldDogUGFydGlhbEJhbGFuY2VTaGVldCkge1xuICByZXR1cm4gY2FsY1NlY3Rpb25Ub3RhbChcbiAgICBzaGVldC5saWFiaWxpdGllcyxcbiAgICAoKSA9PiBjYWxjVG90YWxDdXJyZW50TGlhYmlsaXRpZXMoc2hlZXQpLFxuICAgICgpID0+IGNhbGNUb3RhbE5vbkN1cnJlbnRMaWFiaWxpdGllcyhzaGVldCksXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWxjRXF1aXR5KHNoZWV0OiBQYXJ0aWFsQmFsYW5jZVNoZWV0KSB7XG4gIHJldHVybiBzaGVldC5lcXVpdHkgPz8gbWFwU3VtKGNhbGNUb3RhbEFzc2V0cyhzaGVldCksIGxlc3MoY2FsY1RvdGFsTGlhYmlsaXRpZXMoc2hlZXQpKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWxjTGlxdWlkYXRpb25WYWx1ZShzaGVldDogUGFydGlhbEJhbGFuY2VTaGVldCkge1xuICByZXR1cm4gbWFwU3VtKFxuICAgIGNhbGNFcXVpdHkoc2hlZXQpLFxuICAgIGxlc3MoY2FsY1RvdGFsU2hpcHMoc2hlZXQpKSxcbiAgICBsZXNzKGNhbGNUb3RhbEludGFuZ2libGVBc3NldHMoc2hlZXQpKSxcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhbGNRdWlja0Fzc2V0cyhzaGVldDogUGFydGlhbEJhbGFuY2VTaGVldCkge1xuICByZXR1cm4gbWFwU3VtKFxuICAgIGNhbGNUb3RhbENhc2hBbmRDYXNoRXF1aXZhbGVudHMoc2hlZXQpLFxuICAgIGNhbGNUb3RhbExvYW5zUmVjZWl2YWJsZShzaGVldCksXG4gICAgc2hlZXQ/LmFzc2V0cz8uY3VycmVudD8uYWNjb3VudHNSZWNlaXZhYmxlLFxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2FsY1F1aWNrTGlhYmlsaXRpZXMoc2hlZXQ6IFBhcnRpYWxCYWxhbmNlU2hlZXQpIHtcbiAgcmV0dXJuIG1hcFN1bShjYWxjVG90YWxMb2Fuc1BheWFibGUoc2hlZXQpLCBzaGVldD8ubGlhYmlsaXRpZXM/LmN1cnJlbnQ/LmFjY291bnRzUGF5YWJsZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWxjQWNpZFRlc3RSYXRpbyhzaGVldDogUGFydGlhbEJhbGFuY2VTaGVldCkge1xuICByZXR1cm4gbWFwKFtjYWxjUXVpY2tBc3NldHMoc2hlZXQpLCBjYWxjUXVpY2tMaWFiaWxpdGllcyhzaGVldCldLCAoeCwgeSkgPT4geCAvIHkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2FsY0RlYnRSYXRpbyhzaGVldDogUGFydGlhbEJhbGFuY2VTaGVldCkge1xuICByZXR1cm4gbWFwKFtjYWxjVG90YWxMaWFiaWxpdGllcyhzaGVldCksIGNhbGNUb3RhbEFzc2V0cyhzaGVldCldLCAoeCwgeSkgPT4geCAvIHkpO1xufVxuXG5mdW5jdGlvbiBtYXBTdW0oLi4uYXJnczogKG51bWJlciB8IHVuZGVmaW5lZClbXSkge1xuICByZXR1cm4gbWFwKGFyZ3MsIHN1bSk7XG59XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFVQSxTQUFTLGlCQUNQLFlBQ0csTUFDSDtBQUNBLE1BQUksWUFBWSxRQUFXO0FBQ3pCLFdBQU87QUFBQSxFQUNUO0FBRUEsTUFBSSxRQUFRLFVBQVUsUUFBVztBQUMvQixXQUFPLFFBQVE7QUFBQSxFQUNqQjtBQUVBLFNBQU8sUUFBUSxTQUFTLE9BQU8sR0FBRyxLQUFLLElBQUksQ0FBQSxNQUFLLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDN0Q7QUFFQSxTQUFTLEtBQUssT0FBMkI7QUFDdkMsU0FBTyxVQUFVLFNBQVksQ0FBQyxRQUFRO0FBQ3hDO0FBRU8sU0FBUyxrQkFBa0IsT0FBNEI7QUFDNUQsU0FBTztBQUFBLElBQ0wsTUFBTSxRQUFRLFNBQVMsd0JBQXdCO0FBQUEsSUFDL0MsT0FBSyxFQUFFO0FBQUEsSUFDUCxPQUFLLEVBQUU7QUFBQSxFQUFBO0FBRVg7QUFFTyxTQUFTLGdDQUFnQyxPQUE0QjtBQUMxRSxTQUFPO0FBQUEsSUFDTCxNQUFNLFFBQVEsU0FBUztBQUFBLElBQ3ZCLE9BQUssRUFBRTtBQUFBLElBQ1AsTUFBTSxrQkFBa0IsS0FBSztBQUFBLElBQzdCLE9BQUssRUFBRTtBQUFBLEVBQUE7QUFFWDtBQUVPLFNBQVMseUJBQXlCLE9BQTRCO0FBQ25FLFNBQU87QUFBQSxJQUNMLE1BQU0sUUFBUSxTQUFTO0FBQUEsSUFDdkIsT0FBSyxFQUFFO0FBQUEsSUFDUCxPQUFLLEVBQUU7QUFBQSxFQUFBO0FBRVg7QUFFTyxTQUFTLHVCQUF1QixPQUE0QjtBQUNqRSxTQUFPO0FBQUEsSUFDTCxNQUFNLFFBQVEsU0FBUyxXQUFXO0FBQUEsSUFDbEMsT0FBSyxFQUFFO0FBQUEsSUFDUCxPQUFLLEVBQUU7QUFBQSxJQUNQLE9BQUssRUFBRTtBQUFBLElBQ1AsT0FBSyxFQUFFO0FBQUEsSUFDUCxP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
